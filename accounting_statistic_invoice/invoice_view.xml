<?xml version="1.0"?>
<openerp>
    <data>
    <!-- Statistic invoice product: statistic.invoice.product ************** -->
       <!-- Search -->
    <record model="ir.ui.view" id="view_statistic_invoice_product_search">
        <field name="name">statistic.invoice.product.search</field>
        <field name="model">statistic.invoice.product</field>
        <field name="arch" type="xml">
            <search string="Statistic invoice product" version="7.0">        
                <field name="name" /> <!--family-->
                <field name="total" />
                <field name="percentage" />
                <field name="season" />
                <field name="year" />

                <filter name="top_sale" domain="[('top','=',True)]" string="Top sale"/>
                <filter name="low_sale" domain="[('top','=',False)]" string="Low sale"/>

                <filter name="season1" domain="[('season','=',3)]" string="Current season"/>
                <filter name="season2" domain="[('season','=',2)]" string="Season -1"/>
                <filter name="season3" domain="[('season','=',1)]" string="Season -2"/>
                <filter name="season_old" domain="[('season','=',-1)]" string="Extra (Old season)"/>
                <filter name="season_new" domain="[('season','=',4)]" string="Extra (New season)"/>

                <group expand="0" string="Group By">
                    <filter name="group_name" string="Name" context="{'group_by': 'name'}"/>
                    <filter name="group_type" string="Doc. type" context="{'group_by': 'type_document'}"/>
                    <filter name="group_season" string="Season" context="{'group_by': ('season')}"/>
                    <filter name="group_year" string="Year" context="{'group_by': ('year')}"/>
                    <filter name="group_month" string="Month" context="{'group_by': 'month'}"/>
                    <filter name="group_top" string="Top sale" context="{'group_by': 'top'}"/>
                    <filter name="group_default" string="Def.: M + S" context="{'group_by': ('month','season')}"/>
                </group>                
            </search>
        </field>
    </record>

       <!-- Form -->
    <record model="ir.ui.view" id="view_statistic_invoice_product_form">
        <field name="name">Statistiche prodotto (fatture+OC) divisi per mese</field>
        <field name="model">statistic.invoice.product</field>
        <field name="arch" type="xml">
            <form string="Statistic invoice product" version="7.0">
               <sheet>
                    <group colspan="4" col="4">
                        <field name="top" invisible="1"/>
                        <field name="season" />
                        <field name="year" />
                        <field name="month" />
                        <field name="name" />
                        <field name="total" />
                        <field name="type_document" invisible="1"/>
                    </group>
               </sheet>
            </form>
        </field>
    </record>

       <!-- Tree -->
    <record model="ir.ui.view" id="view_statistic_invoice_product_tree">
        <field name="name">Statistiche prodotto (fatture+OC) divisi per mese</field>
        <field name="model">statistic.invoice.product</field>
        <field name="arch" type="xml">
            <tree string="Statistic invoice product" colors="green:top==True">
                <field name="top" invisible="1"/>
                <field name="season" />
                <field name="year" />
                <field name="month" />
                <field name="name" />
                <field name="total" />
                <field name="type_document" invisible="1"/>
            </tree>
        </field>
    </record>
 
       <!-- Graph -->
     <record model="ir.ui.view" id="view_statistic_invoice_product_graph">
        <field name="name">Grafico statistiche prodotto (fatture+OC) divisi per mese</field>
        <field name="model">statistic.invoice.product</field>
        <field name="arch" type="xml">
            <graph string="trend by product" type="bar">
                <field name="month"/>
                <field name="total" operator="+" />
            </graph>
        </field>
    </record>
     <record model="ir.ui.view" id="view_statistic_invoice_product_stagione_graph">
        <field name="name">Grafico statistiche prodotto (fatture+OC) divisi per stagione</field>
        <field name="model">statistic.invoice.product</field>
        <field name="priority" eval="20" />
        <field name="arch" type="xml">
            <graph string="trend by product" type="bar">
                <field name="name"/>
                <field name="total" operator="+" />
            </graph>
        </field>
    </record>
   
       <!-- Action -->
    <record model="ir.actions.act_window" id="action_statistic_invoice_product">
        <field name="name">Product invoice+OC (green = top sale product)</field>
        <field name="res_model">statistic.invoice.product</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form,graph</field>
        <field name="view_id" ref="view_statistic_invoice_product_tree"/>
        <field name="search_view_id" ref="view_statistic_invoice_product_search"/>
        <field name="context">{'search_default_group_default':1}</field>
    </record>

    <!-- Statistic Order: statistic.invoice.product ************************ -->
    <record model="ir.ui.view" id="view_statistic_invoice_product_removed_search">
        <field name="name">statistic.invoice.product.search.removed</field>
        <field name="model">statistic.invoice.product.removed</field>
        <field name="type">search</field>
        <field name="arch" type="xml">
            <search string="Famiglie da rimuovere">
                    <field name="name" />
            </search>
        </field>
    </record>
    <record model="ir.ui.view" id="view_statistic_invoice_product_removed_form">
        <field name="name">Prodotti da rimuovere</field>
        <field name="model">statistic.invoice.product.removed</field>
        <field name="type">form</field>
        <field name="arch" type="xml">
            <form string="Famiglie to remove">
                <field name="name" />
            </form>
        </field>
    </record>
    <record model="ir.ui.view" id="view_statistic_invoice_product_removed_tree">
        <field name="name">Prodotti da rimuovere</field>
        <field name="model">statistic.invoice.product.removed</field>
        <field name="type">tree</field>
        <field name="arch" type="xml">
            <tree string="Famiglie da rimuovere">
                <field name="name" />
            </tree>
        </field>
    </record>
    <record model="ir.actions.act_window" id="action_statistic_invoice_product_removed">
        <field name="name">Famiglie da rimuovere</field>
        <field name="res_model">statistic.invoice.product.removed</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>
        <field name="search_view_id" ref="view_statistic_invoice_product_removed_search"/>
    </record>
    
    <!--statistic.invoice.agent-->
    <record model="ir.ui.view" id="view_statistic_agents_form">
        <field name="name">statistic.invoice.agent.form</field>
        <field name="model">statistic.invoice.agent</field>
        <field name="arch" type="xml">
            <form string="Statistic tree">
                <field name="hide_statistic"/>
                <!--<field name="trend" />-->
                <field name="name" />
            </form>
        </field>
    </record>
    <record model="ir.ui.view" id="view_statistic_agents_tree">
        <field name="name">statistic.invoice.agent.tree</field>
        <field name="model">statistic.invoice.agent</field>
        <field name="arch" type="xml">
            <tree string="Statistic tree">
                <field name="hide_statistic"/>
                <!--<field name="trend" />-->
                <field name="name" />
            </tree>
        </field>
    </record>
    <record model="ir.actions.act_window" id="action_statistic_agents_configuration">
        <field name="name">Agenti</field>
        <field name="res_model">statistic.invoice.agent</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>
    </record>

    
      <!--Statistic invoice: statistic.invoice **************************** -->
        <record model="ir.ui.view" id="view_statistic_invoice_search">
        <field name="name">statistic.invoice.search</field>
        <field name="model">statistic.invoice</field>
        <field name="arch" type="xml">
            <search string="Statistic invoice">
                <group col="10" colspan="4">
                    <field name="name" />
                    <field name="partner_id"/>
                    <field name="month"/>
                </group>
                <newline/>
                <group expand="0" string="Group By..." colspan="14">
                    <filter string="Partner" icon="terp-stock_symbol-selection" domain="[]" context="{'group_by':'partner_id'}"/>
                </group>
            </search>
        </field>
    </record>
    <record model="ir.ui.view" id="view_statistic_invoice_nation_search">
        <field name="name">statistic.invoice.nation.search</field>
        <field name="model">statistic.invoice</field>
        <field name="priority" eval="40" />
        <field name="arch" type="xml">
            <search string="Statistic invoice nation">
                <group col="10" colspan="4">
                    <field name="name" />
                    <field name="partner_id"/>
                    <field name="month"/>
                    <field name="zone_id"/>
                    <field name="country_id"/>
                </group>
                <newline/>
                <group expand="0" string="Group By..." colspan="14">
                    <filter string="Partner" icon="terp-stock_symbol-selection" domain="[]" context="{'group_by':'partner_id'}"/>
                    <filter string="Nation" icon="terp-stock_symbol-selection" domain="[]" context="{'group_by':'country_id'}"/>
                    <filter string="Zone" icon="terp-stock_symbol-selection" domain="[]" context="{'group_by':'zone_id'}"/>
                </group>
            </search>
        </field>
    </record>

       <!-- Form -->
    <record model="ir.ui.view" id="view_statistic_invoice_form">
        <field name="name">statistic.invoice.form</field>
        <field name="model">statistic.invoice</field>
        <field name="arch" type="xml">
            <form string="Statistic invoice Form">
                <field name="partner_id"/>
                <field name="invoice_agent_id"/>
                <field name="total_last_last" />
                <field name="total_last"/>
                <field name="total"/>
                <field name="month"/>
            </form>
        </field>
    </record>

       <!-- Tree -->
    <record model="ir.ui.view" id="view_statistic_invoice_tree">
        <field name="name">statistic.invoice.tree</field>
        <field name="model">statistic.invoice</field>
        <field name="arch" type="xml">
            <tree string="Statistic invoice Tree">
                <field name="partner_id"/>
                <field name="invoice_agent_id"/>
                <field name="country_id"/>
                <field name="zone_id"/>
                <field name="total_last_last_last_last" sum="Totale -4" />
                <field name="total_last_last_last" sum="Totale -3" />
                <field name="total_last_last" sum="Totale -2" />
                <field name="total_last" sum="Totale -1" />
                <field name="total" sum="Totale" />
                <field name="month"/>
            </tree>
        </field>
    </record>
    
       <!-- Graph -->
    <!-- Per Fatturato Nazione: -->
    <record model="ir.ui.view" id="view_invoice_nation_graph">
        <field name="name">Fatturato nazione (barre)</field>
        <field name="model">statistic.invoice</field>
        <field name="priority" eval="40"/>
        <field name="arch" type="xml">
            <graph string="Fatturato nazioni" type="bar">
                <field name="country_id"/> <!--also zone_id-->
                <field name="total" operator="+" />
            </graph>
        </field>
    </record>
    <record model="ir.ui.view" id="view_invoice_nation_zone_graph">
        <field name="name">Fatturato zone (barre)</field>
        <field name="model">statistic.invoice</field>
        <field name="priority" eval="40"/>
        <field name="arch" type="xml">
            <graph string="Fatturato zone" type="bar">
                <field name="zone_id"/>
                <field name="total" operator="+" />
            </graph>
        </field>
    </record>
    <record model="ir.ui.view" id="view_invoice_total_graph">
        <field name="name">Fatturato complessivo (barre)</field>
        <field name="model">statistic.invoice</field>
        <field name="priority" eval="40"/>
        <field name="arch" type="xml">
            <graph string="Fatturato complessivo" type="bar">
                <field name="season_total"/> 
                <field name="total" operator="+" />
            </graph>
        </field>
    </record>

    <!-- Per Fatturato Agenti: -->
    <record model="ir.ui.view" id="view_invoice_agent_hide_statistic_graph">
        <field name="name">Fatturato agente visibile (barre)</field>
        <field name="model">statistic.invoice</field>
        <field name="priority" eval="40"/>
        <field name="arch" type="xml">
            <graph string="Fatturato agente visibile Italia" type="bar">
                <field name="invoice_agent_id"/>
                <field name="total" operator="+" />
            </graph>
        </field>
    </record>

    <record model="ir.ui.view" id="view_invoice_agent_graph">
        <field name="name">Fatturato agente (barre)</field>
        <field name="model">statistic.invoice</field>
        <field name="priority" eval="40"/>
        <field name="arch" type="xml">
            <graph string="Fatturato agente Italia" type="bar">
                <field name="invoice_agent_id"/>
                <field name="total" operator="+" />
            </graph>
        </field>
    </record>

    <record model="ir.ui.view" id="view_invoice_trend_graph">
        <field name="name">Statistic invoice Graph</field>
        <field name="model">statistic.invoice</field>
        <field name="arch" type="xml">
            <graph string="trend by date" type="bar">
                <field name="month"/>
                <field name="total" operator="+" />
            </graph>
        </field>
    </record>

       <!-- Action -->
    <record model="ir.actions.act_window" id="action_statistic_invoice">
        <field name="name">Statistic invoice Date</field>
        <field name="res_model">statistic.invoice</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,graph,form</field>
        <field name="search_view_id" ref="view_statistic_invoice_search" />
    </record>

       <!-- Dashboards: -->
       <!-- AGENTI: -->   
       <!--PRECEDENTE AZIONE: view_invoice_agent_graph *********************-->
       <record model="ir.actions.act_window" id="action_statistic_invoice_agent_i_True_dashboard">
            <field name="name">Fatture Agente Italia</field>
            <field name="res_model">statistic.invoice</field>
            <field name="view_type">form</field>
            <field name="view_mode">graph,tree,form</field> 
            <field name="context">{'graph_view_ref':'accounting_statistic_invoice.view_invoice_agent_hide_statistic_graph'}</field>
            <field name="domain">[('type_cei','=','i'),('invoice_agent_id','!=',False)]</field>
            <field name="search_view_id" ref="view_statistic_invoice_search" />
       </record>       
       <record model="ir.actions.act_window" id="action_statistic_invoice_agent_i_False_dashboard">
            <field name="name">Fatture Agente Italia (no agente)</field>
            <field name="res_model">statistic.invoice</field>
            <field name="view_type">form</field>
            <field name="view_mode">graph,tree,form</field> 
            <field name="context">{'graph_view_ref':'accounting_statistic_invoice.view_invoice_agent_graph'}</field>
            <field name="domain">[('type_cei','=','i'),('invoice_agent_id','=',False)]</field>
            <field name="search_view_id" ref="view_statistic_invoice_search" />
       </record>       
       <record model="ir.actions.act_window" id="action_statistic_invoice_agent_e_True_dashboard">
            <field name="name">Fatture Agente Estero</field>
            <field name="res_model">statistic.invoice</field>
            <field name="view_type">form</field>
            <field name="view_mode">graph,tree,form</field> <!--TODO CONTEXT CON VISTA GRAPH -->
            <field name="context">{'graph_view_ref':'accounting_statistic_invoice.view_invoice_agent_hide_statistic_graph'}</field>
            <field name="domain">[('type_cei','!=','i'),('invoice_agent_id','!=',False)]</field>
            <field name="search_view_id" ref="view_statistic_invoice_search" />
       </record>       
       
       
       <record model="ir.actions.act_window" id="action_statistic_nation_graph_form">
            <field name="name">Fatture Nazione</field>
            <field name="res_model">statistic.invoice</field>
            <field name="view_type">form</field>
            <field name="view_mode">graph,tree,form</field> <!--TODO CONTEXT CON VISTA GRAPH -->
            <field name="context">{'graph_view_ref':'accounting_statistic_invoice.view_invoice_nation_graph','search_view_ref':'accounting_statistic_invoice.view_statistic_invoice_nation_search'}</field>
            <field name="domain">[]</field>
            <field name="search_view_id" ref="view_statistic_invoice_nation_search" />
       </record>       
       <!--3 action for Zone (area, state, region)-->
       <record model="ir.actions.act_window" id="action_statistic_nation_zone_area_graph_form">
            <field name="name">Fatture Nazione (zone: macro aree)</field>
            <field name="res_model">statistic.invoice</field>
            <field name="view_type">form</field>
            <field name="view_mode">graph,tree,form</field> <!--TODO CONTEXT CON VISTA GRAPH (State)-->
            <field name="context">{'graph_view_ref':'accounting_statistic_invoice.view_invoice_nation_zone_graph','search_view_ref':'accounting_statistic_invoice.view_statistic_invoice_nation_search'}</field>
            <field name="domain">['|',('zone_type','=',False),('zone_type','=','area')]</field>
            <field name="search_view_id" ref="view_statistic_invoice_nation_search" /> <!--zone??-->
       </record> 
       <record model="ir.actions.act_window" id="action_statistic_nation_zone_graph_form">
            <field name="name">Fatture Nazione (zone: stati)</field>
            <field name="res_model">statistic.invoice</field>
            <field name="view_type">form</field>
            <field name="view_mode">graph,tree,form</field> <!--TODO CONTEXT CON VISTA GRAPH (State)-->
            <field name="context">{'graph_view_ref':'accounting_statistic_invoice.view_invoice_nation_zone_graph','search_view_ref':'accounting_statistic_invoice.view_statistic_invoice_nation_search'}</field>
            <field name="domain">[('zone_type','=','state')]</field>
            <field name="search_view_id" ref="view_statistic_invoice_nation_search" /> <!--zone??-->
       </record> 
       <record model="ir.actions.act_window" id="action_statistic_nation_zone_region_graph_form">
            <field name="name">Fatture Nazione (zone: regioni)</field>
            <field name="res_model">statistic.invoice</field>
            <field name="view_type">form</field>
            <field name="view_mode">graph,tree,form</field> <!--TODO CONTEXT CON VISTA GRAPH -->
            <field name="context">{'graph_view_ref':'accounting_statistic_invoice.view_invoice_nation_zone_graph','search_view_ref':'accounting_statistic_invoice.view_statistic_invoice_nation_search'}</field>
            <field name="domain">[('zone_type','=','region')]</field>
            <field name="search_view_id" ref="view_statistic_invoice_nation_search" /> <!--zone??-->
       </record>       

       <record model="ir.actions.act_window" id="action_statistic_total_graph_form">
            <field name="name">Fatture Complessivo</field>
            <field name="res_model">statistic.invoice</field>
            <field name="view_type">form</field>
            <field name="view_mode">graph,tree,form</field> <!--TODO CONTEXT CON VISTA GRAPH -->
            <field name="context">{'graph_view_ref':'accounting_statistic_invoice.view_invoice_total_graph'}</field>
            <field name="domain">[]</field>
       </record>              
       
       <record model="ir.actions.act_window" id="action_statistic_invoice_agent_e_False_dashboard">
            <field name="name">Fatture Agente Estero (no agente)</field>
            <field name="res_model">statistic.invoice</field>
            <field name="view_type">form</field>
            <field name="view_mode">graph,tree,form</field> <!--TODO CONTEXT CON VISTA GRAPH -->
            <field name="context">{'graph_view_ref':'accounting_statistic_invoice.view_invoice_agent_graph'}</field>
            <field name="domain">[('type_cei','!=','i'),('invoice_agent_id','=',False)]</field>
            <field name="search_view_id" ref="view_statistic_invoice_search" />
       </record>       
       
       
       <!-- Action per fatturato trend diviso per mese-->
    <record model="ir.actions.act_window" id="action_statistic_invoice_dashboard">
        <field name="name">Statistic invoice Date</field>
        <field name="res_model">statistic.invoice</field>
        <field name="view_type">form</field>
        <field name="view_mode">graph,tree,form</field>
        <field name="search_view_id" ref="view_statistic_invoice_search" />
    </record>       
    
    <!--Non utilizzata!!!!!!!!--> 
    <record model="ir.actions.act_window" id="action_statistic_invoice_dashboard_best">
        <field name="name">Statistic invoice Date (best customers)</field>
        <field name="res_model">statistic.invoice</field>
        <field name="view_type">form</field>
        <field name="view_mode">graph,tree,form</field>
        <field name="search_view_id" ref="view_statistic_invoice_search" />

        <field name="domain">"[('trend','=', True)]"</field>
        <field name="context">{'graph_view_ref': 'accounting_statistic_invoice'.'view_invoice_trend_best_graph'}</field>
    </record>
    
   <menuitem name="Invoice statistic" 
       parent="accounting_statistic_base.menu_base_accounting" 
       id="menu_accounting_invoice_root" 
       sequence="1" />

       <menuitem name="Invoice per month" 
           parent="menu_accounting_invoice_root" 
           id="menu_accounting_invoice_month"
           sequence="10" 
           action="action_statistic_invoice" />

       <menuitem name="Invoice per product" 
           parent="menu_accounting_invoice_root" 
           id="menu_accounting_invoice_product"
           sequence="15" 
           action="action_statistic_invoice_product" />

       <!--configuration-->
       <menuitem name="Agenti statistiche" 
           parent="accounting_statistic_base.menu_base_mexal_configuration" 
           id="menu_base_mexal_statistic_agent_configuration" 
           sequence="20" 
           action="action_statistic_agents_configuration"/>

      <menuitem name="Famiglie escluse" 
           parent="accounting_statistic_base.menu_base_mexal_configuration" 
           id="menu_statistic_invoice_product_removed" 
           sequence="30" 
           action="action_statistic_invoice_product_removed" />

  </data>
</openerp>
